<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xxliud.github.io</id>
    <title>Zcbb - Workspace</title>
    <updated>2020-07-02T11:15:09.396Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://xxliud.github.io"/>
    <link rel="self" href="https://xxliud.github.io/atom.xml"/>
    <subtitle>å¿µå¿µä¸å¿˜ï¼Œå¿…æœ‰å›å“</subtitle>
    <logo>https://xxliud.github.io/images/avatar.png</logo>
    <icon>https://xxliud.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Zcbb - Workspace</rights>
    <entry>
        <title type="html"><![CDATA[Vue.Js - Serviceä¸“é¢˜]]></title>
        <id>https://xxliud.github.io/post/vue-service/</id>
        <link href="https://xxliud.github.io/post/vue-service/">
        </link>
        <updated>2020-07-02T11:08:20.000Z</updated>
        <content type="html"><![CDATA[<figure data-type="image" tabindex="1"><img src="https://xxliud.github.io/post-images/1593688314406.jpeg" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Vue.Js - Routerä¸“é¢˜]]></title>
        <id>https://xxliud.github.io/post/vue-router/</id>
        <link href="https://xxliud.github.io/post/vue-router/">
        </link>
        <updated>2020-07-02T10:11:41.000Z</updated>
        <content type="html"><![CDATA[<h1 id="è§£è¯»routerindexjsæ–‡ä»¶">è§£è¯»router/index.jsæ–‡ä»¶</h1>
<pre><code class="language-javascript">import Vue from 'vue'
import Router from 'vue-router'
import store from '@/store'
import axios from 'axios'
import myTest from '@/router/modules/myTest'

axios.defaults.withCredentials = true;

Vue.use(Router)

let router = new Router({
  routes: [{
    path: '/',
    component: resolve =&gt; require(['@/layout.vue'], resolve),
    redirect: '/myTest',
    children: [
      ...myTest
    ]
  }, {
    path: '/login',
    component: resolve =&gt; require(['@/pages/login.vue'], resolve)
  }]
})

router.beforeEach((to, from, next) =&gt; {
  let isLogin = store.state.token;
  if (isLogin == null) {
    console.log(isLogin);
    if (to.path !== '/login') {
      return next({
        path: '/login'
      });
    } else {
      next();
    }
  } else {
    if (to.path === '/login') {
      return next({
        path: '/index'
      });
    }
    next();
  }
});

//====change page title after route change

router.afterEach((to, from) =&gt; {
  axios.post(`/api-traceback/api/visitor/insertOne`, {
    source: &quot;flow&quot;,
    username: store.state.user.username,
    url: to.fullPath
  }).then((response) =&gt; {})
});

export default router
</code></pre>
<h1 id="routerå®šä¹‰">routerå®šä¹‰</h1>
<pre><code class="language-javasript">let router = new Router({
  routes: [{
    path: '/',
    component: resolve =&gt; require(['@/layout.vue'], resolve),
    redirect: '/myTest',
    children: [
      ...myTest
    ]
  }, {
    path: '/login',
    component: resolve =&gt; require(['@/pages/login.vue'], resolve)
  }]
})
</code></pre>
<p>ä¸Šè¿°ä»£ç ï¼Œå¤–é¢å®šä¹‰äº†ä¸€ä¸ªè·¯ç”±å¥—ä»¶ï¼Œæœ‰ä¸¤ä¸ªè·¯ç”±åœ°å€ &quot;/&quot; &quot;/login&quot;<br>
é€šè¿‡æµè§ˆå™¨è¯·æ±‚ http://localhost:8080/  http://localhost:8080/login ä¼šè·³è½¬åˆ°ä¸åŒvueé¡µé¢ä¸­</p>
<h2 id="rediret-é‡å®šå‘">rediret é‡å®šå‘</h2>
<p>å¦‚æœåœ¨è·¯ç”±ä¸­å®šä¹‰äº†é‡å®šå‘ï¼Œåˆ™è®¿é—®è¯¥è·¯ç”±ä¼šè·³è½¬åˆ°é‡å®šå‘åçš„åœ°å€</p>
<h2 id="children-å­è·¯ç”±åµŒå¥—è·¯ç”±">children å­è·¯ç”±/åµŒå¥—è·¯ç”±</h2>
<p>å­è·¯ç”±ä¼šæ˜¾ç¤ºåœ¨ä¸»è·¯ç”±é¡µé¢ä¸­<router-view></router-view>æ ‡ç­¾å†…å®¹ä¸­<br>
å­è·¯ç”±çš„å®šä¹‰å’Œä¸»è·¯ç”±ä¸€æ ·ï¼Œéƒ½æ˜¯é‡‡ç”¨jsonæ ¼å¼å®šä¹‰</p>
<h1 id="è·¯ç”±å‰ç½®å¤„ç†å™¨å’Œåç½®å¤„ç†å™¨">è·¯ç”±å‰ç½®å¤„ç†å™¨å’Œåç½®å¤„ç†å™¨</h1>
<pre><code class="language-javascript">router.beforeEach((to, from, next) =&gt; {
  let isLogin = store.state.token;
  if (isLogin == null) {
    console.log(isLogin);
    if (to.path !== '/login') {
      return next({
        path: '/login'
      });
    } else {
      next();
    }
  } else {
    if (to.path === '/login') {
      return next({
        path: '/index'
      });
    }
    next();
  }
});

//====change page title after route change

router.afterEach((to, from) =&gt; {
  axios.post(`/traceback/api/visitor/insertOne`, {
    source: &quot;flow&quot;,
    username: store.state.user.username,
    url: to.fullPath
  }).then((response) =&gt; {})
});
</code></pre>
<p>å¦‚ä¸Šè¿°ä»£ç ç‰‡æ®µæ‰€ç¤ºrouter.beforeEach ä¸ºè·¯ç”±å‰ç½®å¤„ç†å™¨ï¼Œæ‰€æœ‰è¯·æ±‚ä¼šé¦–å…ˆæ‰“åˆ°è¯¥æ–¹æ³•å†…ï¼Œ<br>
æˆ‘ä»¬çœ‹è¿™ä¸ªæ–¹æ³•ï¼Œå›è°ƒé‡Œçš„ä¸‰ä¸ªObject<br>
to: Route å³å°†è¦è¿›å…¥çš„ç›®æ ‡ è·¯ç”±å¯¹è±¡<br>
from: Route: å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±<br>
next: Function: ä¸€å®šè¦è°ƒç”¨è¯¥æ–¹æ³•æ¥ resolve è¿™ä¸ªé’©å­ã€‚æ‰§è¡Œæ•ˆæœä¾èµ– next æ–¹æ³•çš„è°ƒç”¨å‚æ•°ã€‚<br>
ä¸Šè¿°é’©å­åŠŸèƒ½å¤§æ¦‚æ˜¯ï¼Œåˆ¤æ–­å½“æ—¶stateä¸­tokenæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ç»§ç»­ï¼Œä¸å­˜è·³è½¬åˆ°loginè¿›è¡Œç™»å½•ã€‚</p>
<p>router.afterEach ä¸ºè·¯ç”±åç½®å¤„ç†å™¨ï¼Œè·¯ç”±è·³è½¬å®Œæˆåï¼Œä¼šè§¦å‘ï¼Œæˆ‘ä»¬çœ‹è¿™ä¸ªæ–¹æ³•ï¼Œå›è°ƒé‡Œçš„ä¸¤ä¸ªObject<br>
to: Route å³å°†è¦è¿›å…¥çš„ç›®æ ‡ è·¯ç”±å¯¹è±¡<br>
from: Route: å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±<br>
ä¸Šè¿°é’©å­åŠŸèƒ½å¤§æ¦‚æ˜¯ï¼Œå°†ç”¨æˆ·è¯·æ±‚çš„è·¯ç”±ä¿¡æ¯å­˜å…¥æœåŠ¡ç«¯åšè®°å½•ã€‚</p>
<h1 id="è·¯ç”±åˆ©ç”¨urlä¼ é€’å‚æ•°">è·¯ç”±åˆ©ç”¨urlä¼ é€’å‚æ•°</h1>
<ol>
<li>å†’å·å½¢å¼ä¼ é€’ï¼Œç›´æ¥åœ¨å®šä¹‰çš„pathé‡Œç”¨å†’å·å½¢å¼è¡¨ç¤ºå‚æ•°<pre><code class="language-javascript">{
 path:'/params/:newsId/:newsTitle'
</code></pre>
</li>
</ol>
<p>}</p>
<pre><code>2. æ­£åˆ™è¡¨è¾¾å¼ä¼ é€’ï¼Œç›´æ¥åœ¨å®šä¹‰çš„pathé‡Œç”¨å†’å·å½¢å¼è¡¨ç¤ºå‚æ•°
```javascript
{
 path:'/params/:newsId(\\d+)/:newsTitle'
}
</code></pre>
<h1 id="routeå’Œrouterçš„åŒºåˆ†">routeå’Œrouterçš„åŒºåˆ†</h1>
<p>vue-routerä¸­ç»å¸¸ä¼šæ“ä½œçš„ä¸¤ä¸ªå¯¹è±¡routeå’Œrouteå’Œrouterä¸¤ä¸ªã€‚<br>
<img src="https://xxliud.github.io/post-images/1593687614966.webp" alt="" loading="lazy"></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">è±¡</mi></mrow><annotation encoding="application/x-tex">routeå¯¹è±¡
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">è±¡</span></span></span></span>routeå¯¹è±¡è¡¨ç¤ºå½“å‰çš„è·¯ç”±ä¿¡æ¯ï¼ŒåŒ…å«äº†å½“å‰ URL è§£æå¾—åˆ°çš„ä¿¡æ¯ã€‚åŒ…å«å½“å‰çš„è·¯å¾„ï¼Œå‚æ•°ï¼Œqueryå¯¹è±¡ç­‰ã€‚<br>
1.<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>h</mi><mo>âˆ—</mo><mo>âˆ—</mo><mi mathvariant="normal">Â </mi><mi mathvariant="normal">Â </mi><mi mathvariant="normal">Â </mi><mi mathvariant="normal">å­—</mi><mi mathvariant="normal">ç¬¦</mi><mi mathvariant="normal">ä¸²</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">åº”</mi><mi mathvariant="normal">å½“</mi><mi mathvariant="normal">å‰</mi><mi mathvariant="normal">è·¯</mi><mi mathvariant="normal">ç”±</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">è·¯</mi><mi mathvariant="normal">å¾„</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">æ€»</mi><mi mathvariant="normal">æ˜¯</mi><mi mathvariant="normal">è§£</mi><mi mathvariant="normal">æ</mi><mi mathvariant="normal">ä¸º</mi><mi mathvariant="normal">ç»</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">è·¯</mi><mi mathvariant="normal">å¾„</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">å¦‚</mi><mi mathvariant="normal">&quot;</mi><mi mathvariant="normal">/</mi><mi>f</mi><mi>o</mi><mi>o</mi><mi mathvariant="normal">/</mi><mi>b</mi><mi>a</mi><mi>r</mi><mi mathvariant="normal">&quot;</mi><mi mathvariant="normal">ã€‚</mi><mn>2.</mn></mrow><annotation encoding="application/x-tex">route.path**Â  Â  Â  å­—ç¬¦ä¸²ï¼Œå¯¹åº”å½“å‰è·¯ç”±çš„è·¯å¾„ï¼Œæ€»æ˜¯è§£æä¸ºç»å¯¹è·¯å¾„ï¼Œå¦‚&quot;/foo/bar&quot;ã€‚
2.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord">.</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ—</span><span class="mord">Â </span><span class="mord">Â </span><span class="mord">Â </span><span class="mord cjk_fallback">å­—</span><span class="mord cjk_fallback">ç¬¦</span><span class="mord cjk_fallback">ä¸²</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">åº”</span><span class="mord cjk_fallback">å½“</span><span class="mord cjk_fallback">å‰</span><span class="mord cjk_fallback">è·¯</span><span class="mord cjk_fallback">ç”±</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è·¯</span><span class="mord cjk_fallback">å¾„</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ€»</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">æ</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">ç»</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">è·¯</span><span class="mord cjk_fallback">å¾„</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å¦‚</span><span class="mord">&quot;</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord">/</span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord">&quot;</span><span class="mord cjk_fallback">ã€‚</span><span class="mord">2</span><span class="mord">.</span></span></span></span>route.params**Â  Â  Â  ä¸€ä¸ª key/value å¯¹è±¡ï¼ŒåŒ…å«äº†åŠ¨æ€ç‰‡æ®µå’Œå…¨åŒ¹é…ç‰‡æ®µï¼Œå¦‚æœæ²¡æœ‰è·¯ç”±å‚æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚<br>
3.<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo>âˆ—</mo><mo>âˆ—</mo><mi mathvariant="normal">Â </mi><mi mathvariant="normal">Â </mi><mi mathvariant="normal">Â </mi><mi mathvariant="normal">ä¸€</mi><mi mathvariant="normal">ä¸ª</mi><mi>k</mi><mi>e</mi><mi>y</mi><mi mathvariant="normal">/</mi><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">è±¡</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">è¡¨</mi><mi mathvariant="normal">ç¤º</mi><mi>U</mi><mi>R</mi><mi>L</mi><mi mathvariant="normal">æŸ¥</mi><mi mathvariant="normal">è¯¢</mi><mi mathvariant="normal">å‚</mi><mi mathvariant="normal">æ•°</mi><mi mathvariant="normal">ã€‚</mi><mi mathvariant="normal">ä¾‹</mi><mi mathvariant="normal">å¦‚</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">äº</mi><mi mathvariant="normal">è·¯</mi><mi mathvariant="normal">å¾„</mi><mi mathvariant="normal">/</mi><mi>f</mi><mi>o</mi><mi>o</mi><mo>?</mo><mi>u</mi><mi>s</mi><mi>e</mi><mi>r</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">åˆ™</mi><mi mathvariant="normal">æœ‰</mi></mrow><annotation encoding="application/x-tex">route.query**Â  Â  Â  ä¸€ä¸ª key/value å¯¹è±¡ï¼Œè¡¨ç¤ºURLæŸ¥è¯¢å‚æ•°ã€‚ä¾‹å¦‚ï¼Œå¯¹äºè·¯å¾„ /foo?user=1ï¼Œåˆ™æœ‰</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ—</span><span class="mord">Â </span><span class="mord">Â </span><span class="mord">Â </span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">è±¡</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">è¡¨</span><span class="mord cjk_fallback">ç¤º</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">L</span><span class="mord cjk_fallback">æŸ¥</span><span class="mord cjk_fallback">è¯¢</span><span class="mord cjk_fallback">å‚</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">ä¾‹</span><span class="mord cjk_fallback">å¦‚</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">äº</span><span class="mord cjk_fallback">è·¯</span><span class="mord cjk_fallback">å¾„</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mclose">?</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åˆ™</span><span class="mord cjk_fallback">æœ‰</span></span></span></span>route.query.user == 1ï¼Œå¦‚æœæ²¡æœ‰æŸ¥è¯¢å‚æ•°ï¼Œåˆ™æ˜¯ä¸ªç©ºå¯¹è±¡ã€‚<br>
4.<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;#&#039; at position 33: â€¦ å½“å‰è·¯ç”±çš„hashå€¼ (ä¸å¸¦#Ì²) ï¼Œå¦‚æœæ²¡æœ‰ hash å€¼ï¼Œâ€¦'>route.hash**Â  Â  Â  å½“å‰è·¯ç”±çš„hashå€¼ (ä¸å¸¦#) ï¼Œå¦‚æœæ²¡æœ‰ hash å€¼ï¼Œåˆ™ä¸ºç©ºå­—ç¬¦ä¸²ã€‚
5.</span>route.fullPath**Â  Â  Â  å®Œæˆè§£æåçš„URLï¼ŒåŒ…å«æŸ¥è¯¢å‚æ•°å’Œhashçš„å®Œæ•´è·¯å¾„ã€‚<br>
6.<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>e</mi><mi>d</mi><mo>âˆ—</mo><mo>âˆ—</mo><mi mathvariant="normal">Â </mi><mi mathvariant="normal">Â </mi><mi mathvariant="normal">Â </mi><mi mathvariant="normal">æ•°</mi><mi mathvariant="normal">ç»„</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">åŒ…</mi><mi mathvariant="normal">å«</mi><mi mathvariant="normal">å½“</mi><mi mathvariant="normal">å‰</mi><mi mathvariant="normal">åŒ¹</mi><mi mathvariant="normal">é…</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">è·¯</mi><mi mathvariant="normal">å¾„</mi><mi mathvariant="normal">ä¸­</mi><mi mathvariant="normal">æ‰€</mi><mi mathvariant="normal">åŒ…</mi><mi mathvariant="normal">å«</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">æ‰€</mi><mi mathvariant="normal">æœ‰</mi><mi mathvariant="normal">ç‰‡</mi><mi mathvariant="normal">æ®µ</mi><mi mathvariant="normal">æ‰€</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">åº”</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">é…</mi><mi mathvariant="normal">ç½®</mi><mi mathvariant="normal">å‚</mi><mi mathvariant="normal">æ•°</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">è±¡</mi><mi mathvariant="normal">ã€‚</mi><mn>7.</mn></mrow><annotation encoding="application/x-tex">route.matched**Â  Â  Â  æ•°ç»„ï¼ŒåŒ…å«å½“å‰åŒ¹é…çš„è·¯å¾„ä¸­æ‰€åŒ…å«çš„æ‰€æœ‰ç‰‡æ®µæ‰€å¯¹åº”çš„é…ç½®å‚æ•°å¯¹è±¡ã€‚
7.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord">.</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">âˆ—</span><span class="mord">Â </span><span class="mord">Â </span><span class="mord">Â </span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ç»„</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åŒ…</span><span class="mord cjk_fallback">å«</span><span class="mord cjk_fallback">å½“</span><span class="mord cjk_fallback">å‰</span><span class="mord cjk_fallback">åŒ¹</span><span class="mord cjk_fallback">é…</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è·¯</span><span class="mord cjk_fallback">å¾„</span><span class="mord cjk_fallback">ä¸­</span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">åŒ…</span><span class="mord cjk_fallback">å«</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">æœ‰</span><span class="mord cjk_fallback">ç‰‡</span><span class="mord cjk_fallback">æ®µ</span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">åº”</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">é…</span><span class="mord cjk_fallback">ç½®</span><span class="mord cjk_fallback">å‚</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">è±¡</span><span class="mord cjk_fallback">ã€‚</span><span class="mord">7</span><span class="mord">.</span></span></span></span>route.nameÂ  Â  å½“å‰è·¯å¾„åå­—<br>
8.$route.metaÂ  è·¯ç”±å…ƒä¿¡æ¯</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://xxliud.github.io/post-images/1593687646750.webp" alt="" loading="lazy"></figure>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi mathvariant="normal">å¯¹</mi><mi mathvariant="normal">è±¡</mi></mrow><annotation encoding="application/x-tex">routerå¯¹è±¡
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord cjk_fallback">å¯¹</span><span class="mord cjk_fallback">è±¡</span></span></span></span>routerå¯¹è±¡æ˜¯å…¨å±€è·¯ç”±çš„å®ä¾‹ï¼Œæ˜¯routeræ„é€ æ–¹æ³•çš„å®ä¾‹ã€‚</li>
</ul>
<ol>
<li>push</li>
</ol>
<ul>
<li>å­—ç¬¦ä¸²this.$router.push('home')</li>
<li>å¯¹è±¡this.$router.push({path:'home'})</li>
<li>å‘½åçš„è·¯ç”±this.$router.push({name:'user',params:{userId:123}})</li>
<li>å¸¦æŸ¥è¯¢å‚æ•°ï¼Œå˜æˆ /register?plan=123this.$router.push({path:'register',query:{plan:'123'}})ï¼Œpushæ–¹æ³•å…¶å®å’Œ<router-link :to="...">æ˜¯ç­‰åŒçš„ã€‚<br>
æ³¨æ„ï¼špushæ–¹æ³•çš„è·³è½¬ä¼šå‘ history æ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œ<br>
å½“æˆ‘ä»¬ç‚¹å‡»æµè§ˆå™¨çš„è¿”å›æŒ‰é’®æ—¶å¯ä»¥çœ‹åˆ°ä¹‹å‰çš„é¡µé¢ã€‚</li>
</ul>
<ol start="2">
<li>go<br>
é¡µé¢è·¯ç”±è·³è½¬Â ï¼Œå‰è¿›æˆ–è€…åé€€this.$router.go(-1)Â  // åé€€</li>
<li>replace<br>
pushæ–¹æ³•ä¼šå‘ history æ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œè€Œreplaceæ–¹æ³•æ˜¯æ›¿æ¢å½“å‰çš„é¡µé¢ï¼Œä¸ä¼šå‘ history æ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ã€‚</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Vue.Js - Vuex Storeä¸“é¢˜]]></title>
        <id>https://xxliud.github.io/post/vue-vuex/</id>
        <link href="https://xxliud.github.io/post/vue-vuex/">
        </link>
        <updated>2020-06-30T12:11:13.000Z</updated>
        <content type="html"><![CDATA[<h1 id="vuex-storeæ˜¯ä»€ä¹ˆ">Vuex Storeæ˜¯ä»€ä¹ˆï¼Ÿ</h1>
<p>vuex store æ˜¯vueçš„çŠ¶æ€ç®¡ç†æ¨¡å—ï¼Œvuex store æ˜¯å“åº”å¼çš„ï¼Œå½“vueç»„ä»¶ä»storeä¸­è¯»å–çŠ¶æ€ï¼ˆstateï¼‰æ—¶ï¼Œè‹¥storeä¸­çš„çŠ¶æ€å‘ç”Ÿæ›´æ–°æ—¶ï¼Œä¼šåŠæ—¶çš„å“åº”ç»™å…¶ä»–çš„ç»„ä»¶ã€‚<br>
store ä¸­çš„å››ä¸ªæ ¸å¿ƒé€‰é¡¹:     state mutations  getters  actions</p>
<h1 id="æ ¸å¿ƒæ€æƒ³">æ ¸å¿ƒæ€æƒ³</h1>
<ul>
<li>state<br>
stateæ˜¯ç”¨æ¥å­˜æ”¾ç»„ä»¶ä¹‹é—´å…±äº«çš„æ•°æ®ï¼Œä¸€èˆ¬ä¼šåœ¨ç»„ä»¶çš„è®¡ç®—å±æ€§ä¸­è·å–stateçš„æ•°æ®ã€‚<br>
è°ƒç”¨æ–¹æ³•ï¼š this.$store.state.[å±æ€§name]ï¼Œåªæœ‰è¯»å±æ€§ï¼Œæ²¡æœ‰å†™å±æ€§ã€‚</li>
</ul>
<pre><code class="language-javascript">//  '@/store/index.js'
const store = new Vuex.Store({
  state: {
    token: null,
    count: 0
  },
  mutations: mutations,
  modules: {
    user
  }
});

//  '@/pages/myTest/myTest.vue
export default {
  name: 'myTest',
  components: {},
  data() {
    return {
      token: this.$store.state.token
    };
  }
  }
</code></pre>
<ul>
<li>mutations<br>
åœ¨ Vuex store ä¸­ï¼Œå®é™…æ”¹å˜ çŠ¶æ€(state) çš„å”¯ä¸€æ–¹å¼æ˜¯é€šè¿‡æäº¤(commit) ä¸€ä¸ª mutationã€‚<br>
åœ¨ç»„ä»¶é‡Œæäº¤ï¼š this.$store.commit('change', payload)<br>
mutationsä¸‹çš„å‡½æ•°æ¥æ”¶stateä½œä¸ºå‚æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªå«åšpayloadï¼ˆè½½è·ï¼‰çš„ä¸œè¥¿ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªä¸œä¸œæ˜¯ç”¨æ¥è®°å½•å¼€å‘è€…ä½¿ç”¨è¯¥å‡½æ•°çš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´æäº¤äº†ä»€ä¹ˆï¼Œæäº¤çš„ä¸œè¥¿æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ï¼ŒåŒ…å«å¤šä¸ªå­—æ®µï¼Œæ‰€ä»¥è½½è·ä¸€èˆ¬æ˜¯å¯¹è±¡ã€‚</li>
</ul>
<pre><code class="language-javascript">//  '@/store/index.js'
const store = new Vuex.Store({
  state: {
    token: null,
    count: 0
  },
  mutations: mutations,
  modules: {
    user
  }
});

//  '@/store/mutations.js
let mutations = {
  // è®¡æ•°å™¨
  addCount(state, num) {
    if (num) {
      state.count += num;
    }
  }
}

//  '@/pages/myTest/myTest.vue'
export default {
  computed: {
    this.$store.commit('addCount', 2)
  }
}
</code></pre>
<ul>
<li>getters<br>
getterså¯ä»¥çœ‹æˆæ˜¯storeçš„è®¡ç®—å±æ€§ã€‚<br>
gettersä¸‹çš„å‡½æ•°æ¥æ”¶stateä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚getterså¯ä»¥è¿‡æ»¤ç»„ä»¶ä¸­çš„æ•°æ®ï¼Œè¿‡æ»¤çš„æ•°æ®ä¼šå­˜æ”¾åˆ°$store.getterså¯¹è±¡ä¸­ã€‚</li>
</ul>
<pre><code class="language-javascript">//  '@/store/index.js'
const store = new Vuex.Store({
  state: {
    token: null,
    count: 0
  },
  mutations: mutations,
  getters: getters,
  modules: {
    user
  }
});

//  '@/store/getters.js
let getters = {
  // è®¡æ•°å™¨
  getCount(state) {
      return state.count
  }
}

//  '@/pages/myTest/myTest.vue'
export default {
  data: {
      count: this.$store.state.getount();
  }
}
</code></pre>
<ul>
<li>actions<br>
actionsï¼šç±»ä¼¼äºmutation ï¼Œä½†æ˜¯mutationsåªèƒ½å¤„ç†åŒæ­¥å‡½æ•°ï¼Œè€Œactionsåˆ™æ˜¯å¯ä»¥å¤„ç†ä»»ä½•çš„å¼‚æ­¥æ“ä½œã€‚</li>
</ul>
<pre><code class="language-javascript">//  '@/store/index.js'
const store = new Vuex.Store({
  state: {
    token: null,
    count: 0
  },
  mutations: mutations,
  getters: getters,
  actions: actions,
  modules: {
    user
  }
});

//  '@/store/action.js
let actions = {
  // è®¡æ•°å™¨
  getInfo({
    commit
  }, params) {
    commit('updateMail', params.mail);
    commit('updatePhone', params.phone)
  }
}

//  '@/pages/myTest/myTest.vue'
export default {
  computed: {
    this.$store.dispath('getInfo', {'mail': '327xxx@qq.com', 'phone': '139xxxxxxx'})
  }
}
</code></pre>
<p>ğŸ’¡actionså’Œmutationsçš„åŒºåˆ«<br>
1.Actions æäº¤çš„æ˜¯ mutationsï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œactionsä¼šé€šè¿‡mutationsï¼Œè®©mutationså¸®ä»–æäº¤æ•°æ®çš„å˜æ›´ã€‚<br>
2.Action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚</p>
<h1 id="store-åˆ†å±‚">Store åˆ†å±‚</h1>
<p>åˆ†äº«ä¸€ä¸‹æˆ‘é¡¹ç›®ä¸­storeçš„å±‚çº§å…³ç³»<br>
<img src="https://xxliud.github.io/post-images/1593523832808.png" alt="" loading="lazy"></p>
<pre><code class="language-shell">-- store
--- modules  # æ¨¡å—åŒ–
---- user.js   # store.user
--- index.js   # storeå®ä¾‹
--- actions_type.js   # actons type list
--- mutations_type.js  # mutations type list
--- mutations.js   # store -&gt; mutations
</code></pre>
<p>é¡¹ç›®å†…å¹¶æœªä½¿ç”¨gettersï¼Œå¤§éƒ¨åˆ†è®¡ç®—å±æ€§éƒ½æ”¾åˆ°äº†vueçš„computedé‡Œäº†</p>
<ul>
<li>index.js å®šä¹‰storeå®ä¾‹</li>
</ul>
<pre><code class="language-javascript"> // '@/store/index.js'
import Vue from 'vue';
import Vuex from 'vuex';
import mutations from '@/store/mutations';
import user from './modules/user.js'

Vue.use(Vuex);

//=======vuex store start===========
const store = new Vuex.Store({
  state: {
    token: null,
    count: 0
  },
  mutations: mutations,
  modules: {
    user
  }
});
//=======vuex store end===========
export default store
</code></pre>
<ul>
<li>mutations.js å®šä¹‰æ¨¡å—å¤–stateçš„ä¸€äº›å˜æ›´æ–¹æ³•</li>
</ul>
<pre><code class="language-javascript">let mutations = {
  // è®¡æ•°å™¨
  addCount(state, num) {
    if (num) {
      state.count += num;
    }
  }
}
export default mutations
</code></pre>
<ul>
<li>mutations_type.js å®šä¹‰moduleé‡Œmutationsçš„ç±»åˆ«</li>
</ul>
<pre><code class="language-javascript">//user.js
export const SAVE_USER_USERNAME = &quot;SAVE_USER_USERNAME&quot;
export const SAVE_USER_DISPLAYNAME = &quot;SAVE_USER_DISPLAYNAME&quot;
export const SAVE_USER_MAIL = &quot;SAVE_USER_MAIL&quot;
export const SAVE_USER_PHONE = &quot;SAVE_USER_PHONE&quot;
export const SAVE_USER_ROLE = &quot;SAVE_USER_ROLE&quot;
export const SAVE_USER_TOKEN = &quot;SAVE_USER_TOKEN&quot;
</code></pre>
<ul>
<li>actions_type.js å®šä¹‰moduleé‡Œactionsçš„ç±»åˆ«</li>
</ul>
<pre><code class="language-javascript">//user.js
export const COMPUTED_INFO = &quot;COMPUTED_INFO&quot;
</code></pre>
<ul>
<li>modules/user.js å®šä¹‰ä¸€ä¸ªæ¨¡å—user</li>
</ul>
<pre><code class="language-javascript">import {
  GET_USER_MESSAGE,
  SAVE_USER_USERNAME,
  SAVE_USER_DISPLAYNAME,
  SAVE_USER_MAIL,
  SAVE_USER_PHONE,
  SAVE_USER_ROLE,
  SAVE_USER_TOKEN
} from '@/store/mutations_type.js'
import {
  COMPUTED_INFO
} from '@/store/actions_type.js'
import axios from 'axios'
axios.defaults.withCredentials = true;
import router from '@/router';

const state = {
  username: '',
  displayName: '',
  mail: '',
  phone: '',
  role: '',
  projectTree: '',
  token: ''
}

const getters = {

}

const mutations = {
  [SAVE_USER_TOKEN]: (state, value) =&gt; {
    state.token = value
  },
  [SAVE_USER_USERNAME]: (state, value) =&gt; {
    state.username = value
  },
  [SAVE_USER_DISPLAYNAME]: (state, value) =&gt; {
    state.displayName = value
  },
  [SAVE_USER_MAIL]: (state, value) =&gt; {
    state.mail = value
  },
  [SAVE_USER_PHONE]: (state, value) =&gt; {
    state.phone = value
  },
  [SAVE_USER_ROLE]: (state, value) =&gt; {
    state.role = value
  }
}

const actions = {
  [COMPUTED_INFO]: ({
    commit
  }, params) =&gt; {
    commit(SAVE_USER_MAIL, params.mail);
    commit(SAVE_USER_PHONE, params.phone)
  },
  getUserInfo({
    commit
  }, params) {
    commit(SAVE_USER_MAIL, params.mail);
    commit(SAVE_USER_PHONE, params.phone)
  }
}

export default {
  namespaced: true,   // ä¸€å®šè¦æœ‰è¿™ä¸ªkey, å®šä¹‰å‘½åç©ºé—´ç”¨çš„ï¼Œå¦åˆ™å¤–é¢æ‰¾ä¸åˆ°
  state,
  mutations,
  actions
}
</code></pre>
<ul>
<li>vueä¸­å¦‚ä½•é…¸çˆ½çš„ä½¿ç”¨ï¼Ÿ</li>
</ul>
<ol start="2">
<li>è·å–stateå±æ€§</li>
</ol>
<pre><code class="language-javascript">export default {
  name: 'myTest',
  components: {},
  data() {
    return {
      token: this.$store.state.token   // ç²—æš´æ–¹æ³•
    };
  },
  computed: {
    ...mapState({
      count: state =&gt; state.count   // ä¼˜é›…æ–¹æ³•
    })
  }
</code></pre>
<ol>
<li>æ‰§è¡Œmutations</li>
</ol>
<pre><code class="language-javascript">mounted() {
    this.changeUserName(&quot;zcbb...2017&quot;);  // ä¼˜é›…æ–¹æ³•
    this.$store.user.commit(&quot;SAVE_USER_USERNAME&quot;, &quot;zcbb...2015&quot;);  // ç²—æš´æ–¹æ³•
  },
  watch: {},
  created() {},
  methods: {
    ...mapMutations({
      changeUserName: &quot;user/SAVE_USER_USERNAME&quot;
    })
}
</code></pre>
<ol start="3">
<li>æ‰§è¡Œactions</li>
</ol>
<pre><code class="language-javascript">mounted() {
    this.actionUserInfo({         // ä¼˜é›…æ–¹æ³•   
      &quot;mail&quot;: &quot;visir.liu@qq.com&quot;,
      &quot;phone&quot;: &quot;17694806300&quot;
    });
    this.$store.user.dispath(&quot;COMPUTED_INFO&quot;, {     // ç²—æš´æ–¹æ³•
      &quot;mail&quot;: &quot;visir.liu@qq.com&quot;,
      &quot;phone&quot;: &quot;17694806300&quot;
    })
  },
watch: {},
created() {},
methods: {
...mapActions({
    actionUserInfo: &quot;user/COMPUTED_INFO&quot;
    })
}
</code></pre>
<p>è‡³æ­¤vuex storeä»‹ç»å®Œæ¯•..</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Vue.Js - é‡è·¯å­å¤§å…¨]]></title>
        <id>https://xxliud.github.io/post/vue-knowledge/</id>
        <link href="https://xxliud.github.io/post/vue-knowledge/">
        </link>
        <updated>2020-06-24T14:29:12.000Z</updated>
        <content type="html"><![CDATA[<p>[ * ] <a href="https://xxliud.github.io/post/vue-vuex" title="vue-store">vue-store</a> .... storeåˆ†å±‚<br>
[ * ] <a href="https://xxliud.github.io/post/vue-router" title="vue-router">vue-router</a> .... routeråŸºæœ¬æ¦‚å¿µ<br>
[ * ] <a href="https://xxliud.github.io/post/vue-service" title="vue-service">vue-proxy-service</a> .... ç‹¬ç«‹çš„è¯·æ±‚å±‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[K8s - é‡‘ä¸é›€å‘å¸ƒ]]></title>
        <id>https://xxliud.github.io/post/k8s-gray/</id>
        <link href="https://xxliud.github.io/post/k8s-gray/">
        </link>
        <updated>2020-06-23T16:16:43.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>ç¡®è®¤istio-ingressgatewayæ˜¯å¦æœ‰å¯¹å¤–çš„IP</li>
</ul>
<pre><code class="language-shell">kubectl get  service istio-ingressgateway -n istio-system
</code></pre>
<ul>
<li>ç¼–è¾‘EXTERNAL-IPï¼Œå†™å…¥ClusterIPä¸ºå¤–ç½‘ip</li>
</ul>
<pre><code class="language-shell">kubectl edit  service istio-ingressgateway -n istio-system
</code></pre>
<ul>
<li>å»ºç«‹deployment</li>
</ul>
<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx-app-1
spec:
  replicas: 1
  template:
    metadata:
      annotations:
        sidecar.istio.io/inject: &quot;true&quot;
      labels:
        app: nginx-app
        version: v1
    spec:
      containers:
        - name: nginx-app-1
          image: datacenter:v0.0.1
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 80
---

apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx-app-2
spec:
  replicas: 1
  template:
    metadata:
      annotations:
        sidecar.istio.io/inject: &quot;true&quot;
      labels:
        app: nginx-app
        version: v2
    spec:
      containers:
        - name: nginx-app-2
          image: datacenter:v0.0.2
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 80
</code></pre>
<ul>
<li>å»ºç«‹service</li>
</ul>
<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: nginx-svc
  labels:
    svcname: nginx-svc
spec:
  ports:
  - port: 8088
    protocol: TCP
    targetPort: 80
  selector:
    app: nginx-app
</code></pre>
<ul>
<li>å»ºç«‹gateway</li>
</ul>
<pre><code class="language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: nginx-gateway
spec:
  selector:
    istio: ingressgateway # use Istio default gateway implementation
  servers:
  - port:
      number: 80
      name: nginx-http
      protocol: HTTP
    hosts:
    - istio-zcbb.com
</code></pre>
<ul>
<li>å»ºç«‹VirtualService</li>
</ul>
<pre><code class="language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: nginx-vs
spec:
  hosts:
  - istio-zcbb.com
  gateways:
  - nginx-gateway
  http:
  - match:
    - uri:
        prefix: /
    route:
    - destination:
        host: nginx-svc
        subset: v1
      weight: 70
    - destination:
        host: nginx-svc
        subset: v2
      weight: 30
</code></pre>
<ul>
<li>å»ºç«‹DestinationRule</li>
</ul>
<pre><code class="language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: nginx-app
spec:
  host: nginx-svc
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
</code></pre>
<pre><code class="language-shell">Istio Virtual Serviceï¼Œç”¨äºæ§åˆ¶å½“å‰deploymentå’Œé‡‘ä¸é›€deploymentæµé‡åˆ†é…çš„æƒé‡
Istio Destination Ruleï¼ŒåŒ…å«å½“å‰deploymentå’Œé‡‘ä¸é›€deploymentçš„å­é›†ï¼ˆsubsetï¼‰
Istio Gatewayï¼ˆå¯é€‰ï¼‰ï¼Œå¦‚æœæœåŠ¡éœ€è¦ä»å®¹å™¨é›†ç¾¤å¤–è¢«è®¿é—®åˆ™éœ€è¦æ­å»ºgateway
</code></pre>
<p>è‡³æ­¤æœ€ç®€å•çš„é‡‘ä¸é›€å‘å¸ƒå®Œæˆï¼ŒåæœŸå¯ä»¥å®šåˆ¶å„ç§ç°åº¦ç­–ç•¥</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[K8s- è“ç»¿å‘å¸ƒ]]></title>
        <id>https://xxliud.github.io/post/k8s-blue-green/</id>
        <link href="https://xxliud.github.io/post/k8s-blue-green/">
        </link>
        <updated>2020-06-23T16:05:29.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>å®ç°åŸç†ï¼Œå¤špodï¼Œåˆ‡æ¢service versonæŒ‡å‘</li>
<li>å¯åŠ¨ä¸¤ä¸ªç‰ˆæœ¬çš„deployment</li>
</ul>
<pre><code class="language-yaml">--- service æŒ‡å‘v1
apiVersion: v1
kind: Service
metadata:
  name: demo
  namespace: default
  labels:
    app: demo
spec:
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app: demo
    version: v1
--- depliyment v1
apiVersion: apps/v1
kind: Deployment
metadata:
  name: demo1-deployment
  namespace: default
  labels:
    app: demo
    version: v1
spec:
  replicas: 1
  selector:
    matchLabels:
      app: demo
      version: v1
  template:
    metadata:
      labels:
        app: demo
        version: v1
    spec:
      containers:
      - name: demo1
        image: database:v0.01
        ports:
          - name: http
            containerPort: 80
            protocol: TCP

--- depliyment v2
apiVersion: apps/v1
kind: Deployment
metadata:
  name: demo2-deployment
  namespace: default
  labels:
    app: demo
    version: v2
spec:
  replicas: 1
  selector:
    matchLabels:
      app: demo
      version: v2
  template:
    metadata:
      labels:
        app: demo
        version: v2
    spec:
      containers:
      - name: demo2
        image: database:v0.02
        ports:
          - name: http
            containerPort: 80
            protocol: TCP
</code></pre>
<ul>
<li>åˆ‡æ¢å…¥å£æµé‡ä»v1 åˆ° v2</li>
</ul>
<pre><code class="language-shell">kubectl patch service demo -p '{&quot;spec&quot;:{&quot;selector&quot;:{&quot;version&quot;:&quot;v2&quot;}}}'
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[K8s - å®‰è£…ELK]]></title>
        <id>https://xxliud.github.io/post/k8s-elk/</id>
        <link href="https://xxliud.github.io/post/k8s-elk/">
        </link>
        <updated>2020-06-23T15:25:28.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>åˆ›å»ºnamespace elk</li>
</ul>
<pre><code class="language-shell">kubectl create namespace elk
</code></pre>
<ul>
<li>åˆ›å»ºelasticsearch deployment service</li>
</ul>
<pre><code class="language-yaml">--- # elasticsearch deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: elasticsearch
  namespace: elk
  labels:
    app: elasticsearch
spec:
  replicas: 1
  selector:
    matchLabels:
      app: elasticsearch
  template:
    metadata:
      labels:
        app: elasticsearch
    spec:
        hostname: elasticsearch
        containers:
         - image: elasticsearch:6.8.4
           imagePullPolicy: IfNotPresent
           name: elasticsearch
           ports:
             - name: es-port
               containerPort: 9200
             - name: es-tran-port
               containerPort: 9300

--- # elasticsearch service
apiVersion: v1
kind: Service
metadata:
  name: elasticsearch
  namespace: elk
  labels:
    name: elasticsearch
spec:
  type: NodePort
  ports:
  - port: 9200
    targetPort: 9200
    protocol: TCP
    nodePort: 30011
  selector:
    app: elasticsearch
</code></pre>
<ul>
<li>åˆ›å»ºlogstash deployment service, é…ç½®æ–‡ä»¶å‚è€ƒä¹‹å‰æ–‡ç« </li>
</ul>
<pre><code class="language-yaml">--- # logstash deploy
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-logstash
  namespace: elk
  labels:
    app: my-logstash
spec:
  replicas: 1
  selector:
    matchLabels:
      app: my-logstash
  template:
    metadata:
      labels:
        app: my-logstash
    spec:
      containers:
        - name: my-logstash
          image: logstash:6.8.4
          imagePullPolicy: IfNotPresent
          ports:
          - containerPort: 5044
          volumeMounts:
          - name: log-config
            mountPath: /usr/share/pipeline
      volumes:
       - name: log-config
         hostPath:
          path: /Users/xingxu/elk/logstash/pipeline

--- # logstash service
apiVersion: v1
kind: Service
metadata:
  name: my-logstash
  namespace: elk
  labels:
    name: my-logstash
spec:
  type: NodePort
  ports:
  - port: 5044
    targetPort: 5044
    protocol: TCP
    nodePort: 30012
  selector:
    app: my-logstash
</code></pre>
<ul>
<li>åˆ›å»ºkibana deployment service</li>
</ul>
<pre><code class="language-yaml">--- # kibana deploy
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-kibana
  namespace: elk
  labels:
    app: my-kibana
spec:
  replicas: 1
  selector:
    matchLabels:
      app: my-kibana
  template:
    metadata:
      labels:
        app: my-kibana
    spec:
      containers:
        - name: my-kibana
          image: kibana:6.8.4
          imagePullPolicy: IfNotPresent
          ports:
          - containerPort: 5601

--- # kibana service
apiVersion: v1
kind: Service
metadata:
  name: my-kibana
  namespace: elk
  labels:
    name: my-kibana
spec:
  type: NodePort
  ports:
  - port: 5601
    targetPort: 5601
    protocol: TCP
    nodePort: 30010
  selector:
    app: my-kibana
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[K8s - zk&kafkaå®‰è£…]]></title>
        <id>https://xxliud.github.io/post/k8s-zk-kafka/</id>
        <link href="https://xxliud.github.io/post/k8s-zk-kafka/">
        </link>
        <updated>2020-06-23T14:56:48.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>åˆ›å»ºzookerper deployment service</li>
</ul>
<pre><code class="language-yaml">--- # zk deploy
kind: Deployment
apiVersion: apps/v1
metadata:
  name: my-zk
  namespace: base
  labels:
    app: my-zk
spec:
  replicas: 1
  selector:
    matchLabels:
      app: my-zk
  template:
    metadata:
      labels:
        app: my-zk
    spec:
      hostname: my-zk
      dnsPolicy: ClusterFirst
      containers:
      - name: my-zk
        image: zookeeper
        imagePullPolicy: IfNotPresent
        volumeMounts:
        ports:
        - containerPort: 2181
        - containerPort: 2888
        - containerPort: 3888

### zk service
---
apiVersion: v1
kind: Service
metadata:
  name: my-zk
  namespace: base
  labels:
    name: my-zk
spec:
  type: NodePort
  ports:
  - port:
    port: 2181
    targetPort: 2181
    protocol: TCP
        nodePort: 30001
  selector:
    app: my-zk
</code></pre>
<ul>
<li>åˆ›å»ºkafka deployment service</li>
</ul>
<pre><code class="language-yaml">--- # kafka deploy
kind: Deployment
apiVersion: apps/v1
metadata:
  name: my-kafka
  namespace: base
  labels:
    app: my-kafka
spec:
  replicas: 1
  selector:
    matchLabels:
      app: my-kafka
  template:
    metadata:
      labels:
        app: my-kafka
    spec:
      hostname: my-kafka
      dnsPolicy: ClusterFirst
      containers:
      - name: my-kafka
        image: wurstmeister/kafka
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9092
        env:
        - name: KAFKA_ZOOKEEPER_CONNECT
          value: 'my-zk.base:2181'
        - name: KAFKA_ADVERTISED_HOST_NAME
          value: 'ClusterIP'
        - name: KAFKA_ADVERTISED_PORT
          value: 'NodePort'

--- # kafka service
apiVersion: v1
kind: Service
metadata:
  name: my-kafka
  namespace: base
  labels:
    name: my-kafka
spec:
  type: NodePort
  ports:
  - port: 9092
    targetPort: 9092
    protocol: TCP
    nodePort: 30002
  selector:
    app: my-kafka
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[K8s - Mongoå®‰è£…ç¯‡]]></title>
        <id>https://xxliud.github.io/post/k8s-mongo/</id>
        <link href="https://xxliud.github.io/post/k8s-mongo/">
        </link>
        <updated>2020-06-23T14:38:49.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>åˆ›å»ºnamespace</li>
</ul>
<pre><code class="language-shell">kubectl create namespace base
</code></pre>
<ul>
<li>åˆ›å»ºdeployment service</li>
</ul>
<pre><code class="language-yaml">--- # mongo deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-mongo
  namespace: base
  labels:
    app: my-mongo
spec:
  replicas: 1
  selector:
    matchLabels:
      app: my-mongo
  template:
    metadata:
      labels:
        app: my-mongo
    spec:
      containers:
      - name: my-mongo
        image: mongo
        ports:
        - containerPort: 27017

---  # mongo service
apiVersion: v1
kind: Service
metadata:
  name: my-mongo
  namespace: base
  labels:
    name: my-mongo
spec:
  type: NodePort
  ports:
  - port: 27017
    targetPort: 27017
    protocol: TCP
    nodePort: 30000
  selector:
    app: my-mongo
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[K8s - å­¦ä¹ èµ„æ–™æ±‡æ€»]]></title>
        <id>https://xxliud.github.io/post/k8s/</id>
        <link href="https://xxliud.github.io/post/k8s/">
        </link>
        <updated>2020-06-23T12:52:02.000Z</updated>
        <content type="html"><![CDATA[<p>[ * ] <a href="https://xxliud.github.io/post/minikube-install" title="minikube-install">Mac Install Minikube</a><br>
[ * ] <a href="https://xxliud.github.io/post/k8s-mongo" title="k8s-mongo">K8s Install Mongo</a><br>
[ * ] <a href="https://xxliud.github.io/post/k8s-zk-kafka" title="k8s-zk-kafka">K8s Install Zookerper Kafka</a><br>
[ * ] <a href="https://xxliud.github.io/post/k8s-elk" title="k8s-elk">K8s Install ELK</a><br>
[ * ] <a href="https://xxliud.github.io/post/k8s-istio" title="k8s-istio">Install Istio</a><br>
[ * ] <a href="https://xxliud.github.io/post/k8s-blue-green" title="k8s-blue-green">K8s Bule Green Release</a><br>
[ * ] <a href="https://xxliud.github.io/post/k8s-gray" title="k8s-gary">K8s Gray Release</a></p>
]]></content>
    </entry>
</feed>